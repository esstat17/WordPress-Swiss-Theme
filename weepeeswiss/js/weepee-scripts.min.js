/*  
 * mlmenu v1.0.2
 */

!function(e){function t(){e[n].glbl||(l={$wndw:e(window),$html:e("html"),$body:e("body")},i={},a={},o={},e.each([i,a,o],function(e,t){t.add=function(e){e=e.split(" ");for(var n=0,s=e.length;s>n;n++)t[e[n]]=t.mm(e[n])}}),i.mm=function(e){return"ml-"+e},i.add("wrapper menu panel nopanel current highest opened subopened slidemenu hasslidemenu navtitle btn prev next listview nolistview inset vertical selected divider spacer hidden fullsubopen"),i.umm=function(e){return"ml-"==e.slice(0,3)&&(e=e.slice(3)),e},a.mm=function(e){return"ml-"+e},a.add("parent sub"),o.mm=function(e){return e+".mm"},o.add("transitionend webkitTransitionEnd mousedown mouseup touchstart touchmove touchend click keydown"),e[n].objc=i,e[n].objd=a,e[n].obje=o,e[n].glbl=l)}var n="mlmenu",s="offCanvas";if(!e[n]){e[n]=function(e,t,n){this.$menu=e,this._api=["bind","init","update","setSelected","getInstance","openPanel","closePanel","closeAllPanels"],this.opts=t,this.conf=n,this.vars={},this.cbck={},this._initMenu(),this._initAnchors();var s=this.$menu.children(this.conf.panelNodetype);return this._initAddons(),this.init(s),this},e[n].addons={},e[n].uniqueId=0,e[n].defaults={extensions:[],slidemenu:{add:!0,navtitle:"Menu",titleLink:"panel"},onClick:{setSelected:!0},slidingSubmenus:!0},e[n].configuration={classNames:{divider:"Divider",inset:"Inset",panel:"Panel",selected:"Selected",spacer:"Spacer",vertical:"Vertical"},clone:!1,openingInterval:25,panelNodetype:"ul, ol, div",transitionDuration:400},e[n].prototype={init:function(e){e=e.not("."+i.nopanel),e=this._initPanels(e),this.trigger("init",e),this.trigger("update")},update:function(){this.trigger("update")},setSelected:function(e){this.$menu.find("."+i.listview).children().removeClass(i.selected),e.addClass(i.selected),this.trigger("setSelected",e)},openPanel:function(e){var t=e.parent();if(t.hasClass(i.vertical)){var n=t.parents("."+i.subopened);if(n.length)return this.openPanel(n.first());t.addClass(i.opened)}else{if(e.hasClass(i.current))return;var s=this.$menu.children("."+i.panel),a=s.filter("."+i.current);s.removeClass(i.highest).removeClass(i.current).not(e).not(a).not("."+i.vertical).addClass(i.hidden),e.hasClass(i.opened)?e.nextAll("."+i.opened).addClass(i.highest).removeClass(i.opened).removeClass(i.subopened):(e.addClass(i.highest),a.addClass(i.subopened)),e.removeClass(i.hidden).addClass(i.current),setTimeout(function(){e.removeClass(i.subopened).addClass(i.opened)},this.conf.openingInterval)}this.trigger("openPanel",e)},closePanel:function(e){var t=e.parent();t.hasClass(i.vertical)&&(t.removeClass(i.opened),this.trigger("closePanel",e))},closeAllPanels:function(){this.$menu.find("."+i.listview).children().removeClass(i.selected).filter("."+i.vertical).removeClass(i.opened);var e=this.$menu.children("."+i.panel),t=e.first();this.$menu.children("."+i.panel).not(t).removeClass(i.subopened).removeClass(i.opened).removeClass(i.current).removeClass(i.highest).addClass(i.hidden),this.openPanel(t)},togglePanel:function(e){var t=e.parent();t.hasClass(i.vertical)&&this[t.hasClass(i.opened)?"closePanel":"openPanel"](e)},getInstance:function(){return this},bind:function(e,t){this.cbck[e]=this.cbck[e]||[],this.cbck[e].push(t)},trigger:function(){var e=this,t=Array.prototype.slice.call(arguments),n=t.shift();if(this.cbck[n])for(var s=0,i=this.cbck[n].length;i>s;s++)this.cbck[n][s].apply(e,t)},_initMenu:function(){this.opts.offCanvas&&this.conf.clone&&(this.$menu=this.$menu.clone(!0),this.$menu.add(this.$menu.find("[id]")).filter("[id]").each(function(){e(this).attr("id",i.mm(e(this).attr("id")))})),this.$menu.contents().each(function(){3==e(this)[0].nodeType&&e(this).remove()}),this.$menu.parent().addClass(i.wrapper);var t=[i.menu];this.opts.slidingSubmenus||t.push(i.vertical),this.opts.extensions=this.opts.extensions.length?"ml-"+this.opts.extensions.join(" ml-"):"",this.opts.extensions&&t.push(this.opts.extensions),this.$menu.addClass(t.join(" "))},_initPanels:function(t){var n=this,s=this.__findAddBack(t,"ul, ol");this.__refactorClass(s,this.conf.classNames.inset,"inset").addClass(i.nolistview+" "+i.nopanel),s.not("."+i.nolistview).addClass(i.listview);var o=this.__findAddBack(t,"."+i.listview).children();this.__refactorClass(o,this.conf.classNames.selected,"selected"),this.__refactorClass(o,this.conf.classNames.divider,"divider"),this.__refactorClass(o,this.conf.classNames.spacer,"spacer"),this.__refactorClass(this.__findAddBack(t,"."+this.conf.classNames.panel),this.conf.classNames.panel,"panel");var l=e(),r=t.add(t.find("."+i.panel)).add(this.__findAddBack(t,"."+i.listview).children().children(this.conf.panelNodetype)).not("."+i.nopanel);this.__refactorClass(r,this.conf.classNames.vertical,"vertical"),this.opts.slidingSubmenus||r.addClass(i.vertical),r.each(function(){var t=e(this),s=t;t.is("ul, ol")?(t.wrap('<div class="'+i.panel+'" />'),s=t.parent()):s.addClass(i.panel);var a=t.attr("id");t.removeAttr("id"),s.attr("id",a||n.__getUniqueId()),t.hasClass(i.vertical)&&(t.removeClass(n.conf.classNames.vertical),s.add(s.parent()).addClass(i.vertical)),l=l.add(s)});var d=e("."+i.panel,this.$menu);l.each(function(t){var s=e(this),o=s.parent(),l=o.children("a, span").first();if(o.is("."+i.menu)||(o.data(a.sub,s),s.data(a.parent,o)),!o.children("."+i.next).length&&o.parent().is("."+i.listview)){var r=s.attr("id"),d=e('<a class="'+i.next+'" href="#'+r+'" data-target="#'+r+'" />').insertBefore(l);l.is("span")&&d.addClass(i.fullsubopen)}if(!s.children("."+i.slidemenu).length&&!o.hasClass(i.vertical)){if(o.parent().is("."+i.listview))var o=o.closest("."+i.panel);else var l=o.closest("."+i.panel).find('a[href="#'+s.attr("id")+'"]').first(),o=l.closest("."+i.panel);var c=e('<div class="'+i.slidemenu+'" />'),p='<a class="ml-close ml-btn glyphicon glyphicon-remove" href="#ml-0"></a>';if(o.length){var r=o.attr("id");switch(n.opts.slidemenu.titleLink){case"anchor":_url=l.attr("href");break;case"panel":case"parent":_url="#"+r;break;case"none":default:_url=!1}c.append('<a class="'+i.btn+" "+i.prev+'" href="#'+r+'" data-target="#'+r+'"></a>').append('<a class="'+i.navtitle+'"'+(_url?' href="'+_url+'"':"")+">"+l.text()+"</a>").append(p).prependTo(s),n.opts.slidemenu.add&&s.addClass(i.hasslidemenu)}else n.opts.slidemenu.navtitle&&(c.append('<a class="'+i.navtitle+'">'+n.opts.slidemenu.navtitle+"</a>").append(p).prependTo(s),n.opts.slidemenu.add&&s.addClass(i.hasslidemenu))}});var c=this.__findAddBack(t,"."+i.listview).children("."+i.selected).removeClass(i.selected).last().addClass(i.selected);c.add(c.parentsUntil("."+i.menu,"li")).filter("."+i.vertical).addClass(i.opened).end().not("."+i.vertical).each(function(){e(this).parentsUntil("."+i.menu,"."+i.panel).not("."+i.vertical).first().addClass(i.opened).parentsUntil("."+i.menu,"."+i.panel).not("."+i.vertical).first().addClass(i.opened).addClass(i.subopened)}),c.children("."+i.panel).not("."+i.vertical).addClass(i.opened).parentsUntil("."+i.menu,"."+i.panel).not("."+i.vertical).first().addClass(i.opened).addClass(i.subopened);var p=d.filter("."+i.opened);return p.length||(p=l.first()),p.addClass(i.opened).last().addClass(i.current),l.not("."+i.vertical).not(p.last()).addClass(i.hidden).end().appendTo(this.$menu),l},_initAnchors:function(){var t=this;l.$body.on(o.click+"-oncanvas","a[href]",function(s){var a=e(this),o=!1,r=t.$menu.find(a).length;for(var d in e[n].addons)if(o=e[n].addons[d].clickAnchor.call(t,a,r))break;if(!o&&r){var c=a.attr("href");if(c.length>1&&"#"==c.slice(0,1))try{var p=e(c,t.$menu);p.is("."+i.panel)&&(o=!0,t[a.parent().hasClass(i.vertical)?"togglePanel":"openPanel"](p))}catch(h){}}if(o&&s.preventDefault(),!o&&r&&a.is("."+i.listview+" > li > a")&&!a.is('[rel="external"]')&&!a.is('[target="_blank"]')){t.__valueOrFn(t.opts.onClick.setSelected,a)&&t.setSelected(e(s.target).parent());var u=t.__valueOrFn(t.opts.onClick.preventDefault,a,"#"==c.slice(0,1));u&&s.preventDefault(),t.__valueOrFn(t.opts.onClick.blockUI,a,!u)&&l.$html.addClass(i.blocking),t.__valueOrFn(t.opts.onClick.close,a,u)&&t.close()}})},_initAddons:function(){for(var t in e[n].addons)e[n].addons[t].add.call(this),e[n].addons[t].add=function(){};for(var t in e[n].addons)e[n].addons[t].setup.call(this)},__api:function(){var t=this,n={};return e.each(this._api,function(e){var s=this;n[s]=function(){var e=t[s].apply(t,arguments);return"undefined"==typeof e?n:e}}),n},__valueOrFn:function(e,t,n){return"function"==typeof e?e.call(t[0]):"undefined"==typeof e&&"undefined"!=typeof n?n:e},__refactorClass:function(e,t,n){return e.filter("."+t).removeClass(t).addClass(i[n])},__findAddBack:function(e,t){return e.find(t).add(e.filter(t))},__filterListItems:function(e){return e.not("."+i.divider).not("."+i.hidden)},__transitionend:function(e,t,n){var s=!1,i=function(){s||t.call(e[0]),s=!0};e.one(o.transitionend,i),e.one(o.webkitTransitionEnd,i),setTimeout(i,1.1*n)},__getUniqueId:function(){return i.mm(e[n].uniqueId++)}},e.fn[n]=function(s,i){return t(),s=e.extend(!0,{},e[n].defaults,s),i=e.extend(!0,{},e[n].configuration,i),this.each(function(){var t=e(this);if(!t.data(n)){var a=new e[n](t,s,i);t.data(n,a.__api())}})},e[n].support={touch:"ontouchstart"in window||navigator.msMaxTouchPoints};var i,a,o,l;e[n].addons[s]={setup:function(){if(this.opts[s]){var t=this.opts[s],a=this.conf[s];l=e[n].glbl,this._api=e.merge(this._api,["open","close","setPage"]),("top"==t.position||"bottom"==t.position)&&(t.zposition="front"),"string"!=typeof a.pageSelector&&(a.pageSelector="> "+a.pageNodetype),l.$allMenus=(l.$allMenus||e()).add(this.$menu),this.vars.opened=!1;var o=[i.offcanvas];"left"!=t.position&&o.push(i.mm(t.position)),"back"!=t.zposition&&o.push(i.mm(t.zposition)),this.$menu.addClass(o.join(" ")).parent().removeClass(i.wrapper),this.setPage(l.$page),this._initBlocker(),this["_initWindow_"+s](),this.$menu[a.menuInjectMethod+"To"](a.menuWrapperSelector)}},add:function(){i=e[n].objc,a=e[n].objd,o=e[n].obje,i.add("offcanvas slideout modal background opening blocker page"),a.add("style"),o.add("resize")},clickAnchor:function(e,t){if(!this.opts[s])return!1;var n=this.$menu.attr("id");if(n&&n.length&&(this.conf.clone&&(n=i.umm(n)),e.is('[href="#'+n+'"]')))return this.open(),!0;if(l.$page){var n=l.$page.first().attr("id");return n&&n.length&&e.is('[href="#'+n+'"]')?(this.close(),!0):!1}}},e[n].defaults[s]={position:"left",zposition:"back",modal:!1,moveBackground:!0},e[n].configuration[s]={pageNodetype:"div",pageSelector:null,wrapPageIfNeeded:!0,menuWrapperSelector:"body",menuInjectMethod:"prepend"},e[n].prototype.open=function(){if(!this.vars.opened){var e=this;this._openSetup(),setTimeout(function(){e._openFinish()},this.conf.openingInterval),this.trigger("open")}},e[n].prototype._openSetup=function(){var t=this;this.closeAllOthers(),l.$page.each(function(){e(this).data(a.style,e(this).attr("style")||"")}),l.$wndw.trigger(o.resize+"-offcanvas",[!0]);var n=[i.opened];this.opts[s].modal&&n.push(i.modal),this.opts[s].moveBackground&&n.push(i.background),"left"!=this.opts[s].position&&n.push(i.mm(this.opts[s].position)),"back"!=this.opts[s].zposition&&n.push(i.mm(this.opts[s].zposition)),this.opts.extensions&&n.push(this.opts.extensions),l.$html.addClass(n.join(" ")),setTimeout(function(){t.vars.opened=!0},this.conf.openingInterval),this.$menu.addClass(i.current+" "+i.opened)},e[n].prototype._openFinish=function(){var e=this;this.__transitionend(l.$page.first(),function(){e.trigger("opened")},this.conf.transitionDuration),l.$html.addClass(i.opening),this.trigger("opening")},e[n].prototype.close=function(){if(this.vars.opened){var t=this;this.__transitionend(l.$page.first(),function(){t.$menu.removeClass(i.current).removeClass(i.opened),l.$html.removeClass(i.opened).removeClass(i.modal).removeClass(i.background).removeClass(i.mm(t.opts[s].position)).removeClass(i.mm(t.opts[s].zposition)),t.opts.extensions&&l.$html.removeClass(t.opts.extensions),l.$page.each(function(){e(this).attr("style",e(this).data(a.style))}),t.vars.opened=!1,t.trigger("closed")},this.conf.transitionDuration),l.$html.removeClass(i.opening),this.trigger("close"),this.trigger("closing")}},e[n].prototype.closeAllOthers=function(){l.$allMenus.not(this.$menu).each(function(){var t=e(this).data(n);t&&t.close&&t.close()})},e[n].prototype.setPage=function(t){var n=this,a=this.conf[s];t&&t.length||(t=l.$body.find(a.pageSelector),t.length>1&&a.wrapPageIfNeeded&&(t=t.wrapAll("<"+this.conf[s].pageNodetype+" />").parent())),t.each(function(){e(this).attr("id",e(this).attr("id")||n.__getUniqueId())}),t.addClass(i.page+" "+i.slideout),l.$page=t,this.trigger("setPage",t)},e[n].prototype["_initWindow_"+s]=function(){l.$wndw.off(o.keydown+"-offcanvas").on(o.keydown+"-offcanvas",function(e){return l.$html.hasClass(i.opened)&&9==e.keyCode?(e.preventDefault(),!1):void 0});var e=0;l.$wndw.off(o.resize+"-offcanvas").on(o.resize+"-offcanvas",function(t,n){if(1==l.$page.length&&(n||l.$html.hasClass(i.opened))){var s=l.$wndw.height();(n||s!=e)&&(e=s,l.$page.css("minHeight",s))}})},e[n].prototype._initBlocker=function(){var t=this;l.$blck||(l.$blck=e('<div id="'+i.blocker+'" class="'+i.slideout+'" />')),l.$blck.appendTo(l.$body).off(o.touchstart+"-offcanvas "+o.touchmove+"-offcanvas").on(o.touchstart+"-offcanvas "+o.touchmove+"-offcanvas",function(e){e.preventDefault(),e.stopPropagation(),l.$blck.trigger(o.mousedown+"-offcanvas")}).off(o.mousedown+"-offcanvas").on(o.mousedown+"-offcanvas",function(e){e.preventDefault(),l.$html.hasClass(i.modal)||(t.closeAllOthers(),t.close())})};var i,a,o,l}}(jQuery);
